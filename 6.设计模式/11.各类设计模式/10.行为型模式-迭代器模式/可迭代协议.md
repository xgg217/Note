# 可迭代协议

## 概述

+ 在 JS 中，有一些数据结构是天然实现了可迭代协议：

  ```js
  const map = new Map([
    ["a", 1],
    ["b", 2],
    ["c", 3],
  ]);

  for (const [key, value] of map) {
    console.log(`${key}: ${value}`);
  }

  const set = new Set([1, 2, 3]);

  for (const value of set) {
    console.log(value);
  }
  ```

+ 当你的一个数据结构实现了可迭代协议，那么意味着你可以使用 for of 来进行迭代。

+ 如果是没有实现可迭代协议的数据结构，那么就没有办法使用 for of 进行迭代：

  ```js
  const obj = {
    name: "张三",
    age: 18,
    gender: "男",
    [Symbol.iterator]() {
      // 根据可迭代协议书写具体的迭代方式
      const keys = Object.keys(this);
      let index = 0;

      return {
        next: () => {
          if (index < keys.length) {
            // 说明还存在下一个元素
            return {
              value: this[keys[index++]],
              done: false,
            };
          } else {
            // 说明迭代完了，没有更多的元素了
            return {
              value: undefined,
              done: true,
            };
          }
        },
      };
    },
  };

  // for (const idx in obj) {
  //   console.log(idx);
  // }

  for (const item of obj) {
    console.log(item);
  }
  ```

+ 在上面的例子中，我们根据可迭代协议，实现了具体迭代方式，之后对象就可以使用 for of 来进行遍历了

+ 而这个可迭代协议，本质上就是迭代器的一套接口
