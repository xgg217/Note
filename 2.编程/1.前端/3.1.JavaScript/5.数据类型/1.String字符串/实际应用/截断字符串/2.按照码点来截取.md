# æŒ‰ç…§ç ç‚¹æ¥æˆªå–

## æ¦‚è¿°

+ Emoji è¡¨æƒ…

  ```js
  // é•¿åº¦
  const str = "ğŸ‘…ğŸ¶ğŸ‘‹ğŸ‰ğŸ ";
  str.length; // 10
  ```

+ å–å­—ç¬¦çš„ç¬¬ä¸€é¡¹ä¹±ç 

  ```js
  const str = "ğŸ‘…ğŸ¶ğŸ‘‹ğŸ‰ğŸ ";
  str[0] // '\uD83D'
  ```

+ æˆªå–ä¹±ç 

  ```js
  const str = "ğŸ‘…ğŸ¶ğŸ‘‹ğŸ‰ğŸ ";
  str.slice(1,3); // '\uDC45\uD83D'
  ```

  ![æˆªå–æ–‡å­—](æˆªå–æ–‡å­—.png)
  ![äº§ç”Ÿçš„åŸå› ](äº§ç”Ÿçš„åŸå› .png)

## è§£å†³

+ pointLength: ç”¨äºè·å–ç ç‚¹çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…çœ‹åˆ°çš„é•¿åº¦

  ```js
  const str0 = "ğŸ‘…ğŸ¶ğŸ‘‹ğŸ‰ğŸ ";
  const str1 = "ğŸ‘…ğŸ¶ağŸ‘‹ğŸ‰ğŸ ";
  String.prototype.pointLength = function () {
    // å£°æ˜ä¸€ä¸ªå˜é‡ç”¨äºè®°å½•é•¿åº¦
    let len = 0;
    for (let i = 0; i < this.length; ) {
      // é€šè¿‡ codePointAt çš„åˆ°ç å…ƒæ•°
      const codePoint = this.codePointAt(i);
      // æˆ‘ä»¬åˆ©ç”¨ä¸‰ç›®è¿ç®—ç¬¦æ¥å¯¹ i è¿›è¡Œæ§åˆ¶
      i += codePoint > 65536 ? 2 : 1;
      // æ¯ä¸€æ¬¡éƒ½è®°å½•ä¸€ä¸‹é•¿åº¦
      len++;
    }
    return len;
  };
  console.log('pointLength >>> ', str0.pointLength()) // 5
  console.log('pointLength >>> ', str1.pointLength()) // 6
  ```

+ pointAt: ç”¨æ¥è·å–å­—ç¬¦ä¸²æŸä¸€ä¸ªä½ç½®çš„å­—ç¬¦

  ```js
  // index å­—ç¬¦ä¸²çš„ä¸‹æ ‡
  // è¿”å›å½“å‰ä¸‹æ ‡çš„å­—ç¬¦
  String.prototype.pointAt = function (index) {
    let curIndex = 0; // ç ç‚¹çš„ä¸‹æ ‡
    for (let i = 0; i < this.length; ) {
      const codePoint = this.codePointAt(i);
      // å¦‚æœå½“å‰ç ç‚¹çš„ä¸‹æ ‡ä¸ä¼ å…¥çš„ä¸‹æ ‡å€¼ä¸€è‡´å°±è¿”å›å½“å‰çš„ç ç‚¹å€¼
      if (curIndex === index) {
        // è¿™é‡Œæˆ‘ä»¬é€šè¿‡ fromCodePoint æ–¹æ³•å°†ç å…ƒå€¼è½¬æ¢æˆå­—ç¬¦
        return String.fromCodePoint(codePoint);
      }
      // å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„å€¼ç»§ç»­éå†
      i += codePoint > 65536 ? 2 : 1;
      curIndex++;
    }
  };

  const str0 = "ğŸ‘…ğŸ¶ğŸ‘‹ğŸ‰ğŸ ";
  const str1 = "ğŸ‘…ğŸ¶ağŸ‘‹ğŸ‰ğŸ ";
  console.log('pointAt >>> ', str0.pointAt(2)) // ğŸ‘‹
  console.log('pointAt >>> ', str1.pointAt(2)) // a
  ```

+ sliceByPoint: å­—ç¬¦ä¸²æˆªå–

  ```js
  // èµ·å§‹çš„å€¼é»˜è®¤ä¸º 0
  // ç»“æŸçš„ä½ç½®é»˜è®¤ä¸ºç ç‚¹çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯ pointLength å‡½æ•°çš„å€¼
  String.prototype.sliceByPoint = function (start = 0, end = this.pointLength()) {
    let result = "";
    for (let i = start; i < end; i++) {
      result += this.pointAt(i);
    }
    return result;
  };

  const str0 = "ğŸ‘…ğŸ¶ğŸ‘‹ğŸ‰ğŸ ";
  const str1 = "ğŸ‘…ğŸ¶ağŸ‘‹ğŸ‰ğŸ ";
  console.log('sliceByPoint >>> ', str0.sliceByPoint(0,3)) // ğŸ‘…ğŸ¶ğŸ‘‹
  console.log('sliceByPoint >>> ', str1.sliceByPoint(0,3)) // ğŸ‘…ğŸ¶a
  ```
