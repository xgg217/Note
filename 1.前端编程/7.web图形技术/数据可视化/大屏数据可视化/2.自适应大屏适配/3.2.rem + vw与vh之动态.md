# 动态rem + JS + Sass/Less

## 概述

+ 不过，现在只是很简单的页面，实际使用1rem=12px这种换算的话，在对应设计稿的时候，很难换算，而且很容易出现小数，比如：

+ 设计稿px值 / 基准值(12px) = rem值 ---> 设计稿100px ---> 100/12 ≈ 8.333rem

+ 所以实际中，一般都是动态rem + JS + Sass/Less方案

## 核心逻辑

+ 基准值设定：定义1rem = 设计稿宽度的1%（1920px → 19.2px）

  + 但为方便计算，放大100倍 ---> 1rem = 100px

+ 动态计算：通过JS实时计算缩放比例

  ```js
  scale = Math.min(当前宽/设计宽, 当前高/设计高)
  ```

+ 尺寸转换：设计稿元素尺寸直接除以100得到rem值

  + 示例：设计稿500px → 5rem

  ```js
  // 当屏幕宽度=设计稿宽度时
  scale = 1 → fontSize = 100px
  // 当屏幕宽度=960px时
  scale = 960/1920 = 0.5 → fontSize = 50px
  ```

## 示例

+ 示例

  ```html
  <!DOCTYPE html>
  <html lang="zh-CN">
    <head>
      <meta charset="UTF-8" />
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
      />
      <title>专业数据大屏</title>
      <link rel="stylesheet" href="css/main.css" />
    </head>
    <body>
      <div class="dashboard">
        <!-- 头部 -->
        <header class="dashboard-header">
          <h1 class="title">智慧运营中心</h1>
          <div class="time-info">2025年03月 | 实时更新</div>
        </header>

        <!-- 主内容 -->
        <main class="dashboard-content">
          <section class="chart-container left">
            <div class="chart-card">
              <div class="chart-title">业务增长趋势</div>
              <div class="chart-area"></div>
            </div>
          </section>

          <section class="chart-container right">
            <div class="chart-card">
              <div class="chart-title">地域分布热力</div>
              <div class="chart-area"></div>
            </div>
          </section>
        </main>
      </div>

      <script>
        // 动态适配逻辑（保持原有）
        const DESIGN_WIDTH = 1920,
          DESIGN_HEIGHT = 1080;
        function adjustRootFont() {
          const scale = Math.min(
            window.innerWidth / DESIGN_WIDTH,
            window.innerHeight / DESIGN_HEIGHT
          );
          document.documentElement.style.fontSize = `${scale * 100}px`;
        }

        // 初始化监听
        window.addEventListener("resize", () => {
          requestAnimationFrame(() => {
            adjustRootFont();
          });
        });
        adjustRootFont();
      </script>
    </body>
  </html>
  ```

  ```css
  @use "sass:math";

  // 设计系统参数
  $design-width: 1920;
  $design-height: 1080;
  $base-rem: 100; // 1rem = 100px
  $color-primary: #2a85ff;
  $color-bg: #1a1d28;
  $color-card: #252a38;

  // 单位转换
  @function px2rem($px) {
    @return math.div($px, $base-rem) * 1rem;
  }

  // 混合器：卡片效果
  @mixin neumorphism-card {
    background: $color-card;
    border-radius: px2rem(12);
    box-shadow:
      0 px2rem(8) px2rem(24) rgba(0,0,0,0.15),
      0 0 px2rem(2) rgba(255,255,255,0.1);
  }

  /* 基础重置 */
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Microsoft YaHei', sans-serif;
  }

  html {
    font-size: 100px; // JS动态覆盖
  }

  body {
    background: $color-bg;
    color: #fff;
    overflow: hidden;
  }

  /* 主容器 */
  .dashboard {
    width: 100vw;
    height: 100vh;
    display: flex;
    flex-direction: column;
    padding: px2rem(20);
  }

  /* 头部区域 */
  .dashboard-header {
    height: px2rem(80);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 px2rem(40);
    margin-bottom: px2rem(20);

    .title {
      font-size: px2rem(36);
      font-weight: bold;
      background: linear-gradient(135deg, #6b8dd6, $color-primary);
      background-clip: text;
    }

    .time-info {
      font-size: px2rem(24);
      color: rgba(255,255,255,0.8);
    }
  }

  /* 主内容区 */
  .dashboard-content {
    flex: 1;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: px2rem(20);
    overflow: hidden;

    .chart-container {
      height: 100%;
      @include neumorphism-card;
      padding: px2rem(20);

      .chart-card {
        height: 100%;
        display: flex;
        flex-direction: column;

        .chart-title {
          font-size: px2rem(24);
          margin-bottom: px2rem(16);
          padding-left: px2rem(10);
          border-left: px2rem(4) solid $color-primary;
        }

        .chart-area {
          flex: 1;
          background: rgba(255,255,255,0.05);
          border-radius: px2rem(8);
        }
      }
    }
  }

  /* 响应式适配 */
  @media (max-aspect-ratio: 16/9) {
    .dashboard-content {
      grid-template-columns: 1fr;
      // 增加以下优化代码
      gap: px2rem(10);  // 缩小间距
      padding-bottom: px2rem(20);  // 底部留白

      .chart-container {
        height: auto;  // 取消固定高度
        min-height: px2rem(400);  // 设置最小高度
        flex: 1;  // 启用弹性填充
      }
    }

    // 添加超小屏幕适配
    @media (max-height: 600px) {
      .dashboard-header {
        height: px2rem(60);
        padding: 0 px2rem(20);

        .title {
          font-size: px2rem(24);
        }

        .time-info {
          font-size: px2rem(18);
        }
      }

      .chart-container {
        min-height: px2rem(300) !important;

        .chart-area {
          height: px2rem(200) !important;
        }
      }
    }
  }
  ```
