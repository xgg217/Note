# 基础

## 概述

+ BufferAttribute 是 Three.js 中用于高效管理几何体属性数据的核心类

## 特点

+ 数据存储

  + 专为存储 BufferGeometry 的各种属性设计，包括： 顶点位置（position）、法线向量（normal）、颜色值（color）、UV坐标（uv）、面片索引（index）、自定义属性（如实例化数据）

+ GPU优化

  + 采用类型化数组（TypedArray）存储数据，通过连续内存布局实现：显存高效传输、适合WebGL底层渲染管线、支持静态/动态数据更新策略

+ 矢量处理

  + 数据按矢量单元存储（通过itemSize定义维度）、 所有方法中的index参数会自动乘以矢量长度定位数据

    ```js
    // 快速读取矢量数据
    const vec = new THREE.Vector3().fromBufferAttribute(attribute, index)
    ```

## 构造函数

+ `BufferAttribute( array : TypedArray, itemSize : Integer, normalized : Boolean )`

  + array 必须是TypedArray类型，包含 `itemSize * numVertices` 个元素
  + itemSize 每个顶点的数据维度（如位置/法线为3，UV为2）
  + normalized 是否将整数类型数据归一化到GLSL范围

    + 如UInt16Array→[0,1]）


## 示例

+ 示例1

  ```js
  // 1. 创建顶点数据（x,y,z 坐标）
  const positions = new Float32Array([
    0, 0, 0,  // 顶点1
    1, 0, 0,  // 顶点2
    0, 1, 0   // 顶点3
  ]);
  // 2. 创建BufferAttribute
  const positionAttribute = new THREE.BufferAttribute(positions, 3); // 3表示每个顶点3个分量(x,y,z)
  // 3. 添加到几何体
  const geometry = new THREE.BufferGeometry();
  geometry.setAttribute('position', positionAttribute);
  // 4. 创建材质和网格
  const material = new THREE.MeshBasicMaterial({ color: 0xff0000 });
  const mesh = new THREE.Mesh(geometry, material);
  scene.add(mesh); // 在场景中渲染一个红色三角形
  ```
