# 强制类型转换

## 概述

+ 在验证之前尝试将输入值转换为目标类型。

  + `z.coerce.string():` 将输入转换为字符串 (使用 `String(input)`)
  + `z.coerce.number():` 将输入转换为数字 (使用 `Number(input)`)
  + `z.coerce.boolean():` 将输入转换为布尔值 (使用 `Boolean(input)`)
  + `z.coerce.date():` 将输入（字符串或数字）转换为日期对象 (使用 `new Date(input)`)

  ```js
  import { z } from 'zod';

  const coercedNumberSchema = z.coerce.number(); // 会尝试 Number(input)
  console.log(coercedNumberSchema.parse("123"));    // 123 (数字)
  console.log(coercedNumberSchema.parse(true));     // 1 (数字)
  // console.log(coercedNumberSchema.parse("abc")); // NaN, 如果后续有 .int() 等校验会失败

  const coercedBooleanSchema = z.coerce.boolean();
  console.log(coercedBooleanSchema.parse("true"));  // true
  console.log(coercedBooleanSchema.parse(""));      // false
  console.log(coercedBooleanSchema.parse(1));       // true
  console.log(coercedBooleanSchema.parse(0));       // false

  const coercedDateSchema = z.coerce.date();
  console.log(coercedDateSchema.parse("2023-10-26T10:00:00.000Z")); // Date 对象
  // console.log(coercedDateSchema.parse("invalid-date")); // 会得到 Invalid Date 对象，后续校验会失败

  // 结合其他校验
  const coercedPositiveNumber = z.coerce.number().positive("必须是正数");
  console.log(coercedPositiveNumber.parse("42")); // 42
  console.log(coercedPositiveNumber.safeParse("-5")); // { success: false, ... }
  console.log(coercedPositiveNumber.safeParse("text")); // { success: false, ... } (因为 Number("text") 是 NaN)
  ```

+ 这比手动使用 `.preprocess()` 进行常见类型转换要方便得多
