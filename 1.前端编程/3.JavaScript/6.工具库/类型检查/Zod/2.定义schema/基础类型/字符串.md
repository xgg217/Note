# 字符串

## 常用

+ string 验证数据是否为字符串

  ```js
  // 导入 z 对象，它是 Zod 库的入口点
  import { z } from 'zod';

  // 创建一个字符串 schema
  const myStringSchema = z.string();

  // 使用 schema 来验证数据
  try {
    const validString = myStringSchema.parse("你好，Zod！"); // ✓ 验证通过，返回 "你好，Zod！"
    console.log("验证通过:", validString);

    const invalidData = myStringSchema.parse(123); // ❌ 验证失败，抛出 ZodError
    console.log("这里不会执行");
  } catch (error) {
    console.error("验证失败:", error.errors); // error 是一个 ZodError 实例
  }
  ```

## 链式校验方法

## 字符串 验证

+ `.min(length, message?)` : 最小长度
+ `.max(length, message?)` : 最大长度
+ `.length(length, message?)` : 固定长度
+ `.email(message?)` : 验证是否为有效的 email 格式
+ `.url(message?)` : 验证是否为有效的 URL 格式
+ `.uuid(message?)` : 验证是否为有效的 UUID 格式
+ `.cuid(message?)` : 验证是否为有效的 CUID 格式
+ `.cuid2(message?)` : 验证是否为有效的 CUID2 格式
+ `.ulid(message?)` : 验证是否为有效的 ULID 格式
+ `.regex(regex, message?)` : 使用正则表达式验证
+ `.startsWith(value, message?)` : 验证字符串是否以特定值开头
+ `.endsWith(value, message?)` : 验证字符串是否以特定值结尾
+ `.nonempty(message?)` : 确保字符串不是空的 (等同于 .min(1))
+ `.datetime(options?)` : 验证 ISO 8601 日期时间字符串
+ `.ip(options?)` : 验证 IP 地址 (v4 或 v6)


  ```js
  import { z } from 'zod';

  const usernameSchema = z.string()
    .min(3, { message: "用户名至少需要3个字符" })
    .max(20, { message: "用户名不能超过20个字符" })
    .regex(/^[a-zA-Z0-9_]+$/, { message: "用户名只能包含字母、数字和下划线" });

  const emailSchema = z.string().email({ message: "无效的邮箱地址" });

  console.log(usernameSchema.safeParse("ab")); // { success: false, error: ... }
  console.log(usernameSchema.safeParse("test_user_123")); // { success: true, data: "test_user_123" }
  console.log(emailSchema.safeParse("test@example.com")); // { success: true, data: "test@example.com" }
  ```

## 字符串 转换

+ 执行简单的字符串转换：

  ```js
  z.string().trim(); // 去除空白
  z.string().toLowerCase(); // 转小写
  z.string().toUpperCase(); // 转大写
  z.string().normalize(); // 规范化 Unicode 字符
  ```

## 邮件

+ 验证邮箱地址：

  ```js
  z.email();
  ```

+ 默认情况下，Zod 使用一种相对严格的邮箱正则表达式，设计用来验证包含常见字符的普通邮箱地址
+ 大致相当于 Gmail 采用的规则

  ```js
  /^(?!\.)(?!.*\.\.)([a-z0-9_'+\-\.]*)[a-z0-9_+-]@([a-z0-9][a-z0-9\-]*\.)+[a-z]{2,}$/i
  ```

+ 要自定义邮箱验证行为，可以向 pattern 参数传递一个自定义正则表达式

  ```js
  z.email({ pattern: /your regex here/ });
  ```

+ Zod 导出了一些实用的正则表达式可供使用

  ```js
  // Zod 默认邮箱正则
  z.email();
  z.email({ pattern: z.regexes.email }); // 等价

  // 浏览器用于 input[type=email] 字段的正则
  // https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/email
  z.email({ pattern: z.regexes.html5Email });

  // 经典 emailregex.com 正则 (RFC 5322)
  z.email({ pattern: z.regexes.rfc5322Email });

  // 一个允许 Unicode 的宽松正则 (适用于国际邮箱)
  z.email({ pattern: z.regexes.unicodeEmail });
  ```
