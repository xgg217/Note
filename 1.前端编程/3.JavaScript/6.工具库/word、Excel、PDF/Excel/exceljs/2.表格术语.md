# 表格数据

## workbook 工作簿

+ workbook：工作簿，可以理解为整个 excel 表格。

+ 通过 `const workbook = new ExcelJS.Workbook()` 创建工作簿，还可以设置工作簿的属性

  ```js
  workbook.creator = 'Me';
  workbook.lastModifiedBy = 'Her';
  workbook.created = new Date(1985, 8, 30);
  workbook.modified = new Date();
  workbook.lastPrinted = new Date(2016, 9, 27);
  ```

## worksheet sheet 页

+ 工作表，即 Excel 表格中的 sheet 页

+ 通过 `const sheet = workbook.addWorksheet('My Sheet')` 创建工作表，每个 workbook 可添加多个 worksheet

+ 使用 addWorksheet 函数的第二个参数来指定工作表的选项

  ```js
  // 创建带有红色标签颜色的工作表
  const sheet = workbook.addWorksheet('My Sheet', {properties:{tabColor:{argb:'FFC0000'}}});

  // 创建一个隐藏了网格线的工作表
  const sheet = workbook.addWorksheet('My Sheet', {views: [{showGridLines: false}]});

  // 创建一个第一行和列冻结的工作表
  const sheet = workbook.addWorksheet('My Sheet', {views:[{xSplit: 1, ySplit:1}]});

  // 使用A4设置的页面设置设置创建新工作表 - 横向
  const worksheet =  workbook.addWorksheet('My Sheet', {
    pageSetup:{paperSize: 9, orientation:'landscape'}
  });

  // 创建一个具有页眉页脚的工作表
  const sheet = workbook.addWorksheet('My Sheet', {
    headerFooter:{firstHeader: "Hello Exceljs", firstFooter: "Hello World"}
  });

  // 创建一个冻结了第一行和第一列的工作表
  const sheet = workbook.addWorksheet('My Sheet', {views:[{state: 'frozen', xSplit: 1, ySplit:1}]});
  ```

## columns 列

+ 列，通过 worksheet.columns可设置表头

  ```js
  // 添加列标题并定义列键和宽度
  // 注意：这些列结构仅是构建工作簿的方便之处，除了列宽之外，它们不会完全保留。
  worksheet.columns = [
    { header: 'Id', key: 'id', width: 10 },
    { header: 'Name', key: 'name', width: 32 },
    { header: 'D.O.B.', key: 'DOB', width: 10, outlineLevel: 1 }
  ];

  // 通过键，字母和基于1的列号访问单个列
  const idCol = worksheet.getColumn('id');
  const nameCol = worksheet.getColumn('B');
  const dobCol = worksheet.getColumn(3);

  // 设置列属性

  // 注意：将覆盖 C1 单元格值
  dobCol.header = 'Date of Birth';

  // 注意：这将覆盖 C1:C2 单元格值
  dobCol.header = ['Date of Birth', 'A.K.A. D.O.B.'];

  // 从现在开始，此列将以 “dob” 而不是 “DOB” 建立索引
  dobCol.key = 'dob';

  dobCol.width = 15;

  // 如果需要，隐藏列
  dobCol.hidden = true;
  ```

+ 还可对列进行各种操作

  ```js
  // 遍历此列中的所有当前单元格
  dobCol.eachCell(function(cell, rowNumber) {
    // ...
  });

  // 遍历此列中的所有当前单元格，包括空单元格
  dobCol.eachCell({ includeEmpty: true }, function(cell, rowNumber) {
    // ...
  });

  // 添加一列新值
  worksheet.getColumn(6).values = [1,2,3,4,5];

  // 添加稀疏列值
  worksheet.getColumn(7).values = [,,2,3,,5,,7,,,,11];

  // 剪切一列或多列（右边的列向左移动）
  // 如果定义了列属性，则会相应地对其进行切割或移动
  // 已知问题：如果拼接导致任何合并的单元格移动，结果可能是不可预测的
  worksheet.spliceColumns(3,2);

  // 删除一列，再插入两列。
  // 注意：第4列及以上的列将右移1列。
  // 另外：如果工作表中的行数多于列插入项中的值，则行将仍然被插入，就好像值存在一样。
  const newCol3Values = [1,2,3,4,5];
  const newCol4Values = ['one', 'two', 'three', 'four', 'five'];
  worksheet.spliceColumns(3, 1, newCol3Values, newCol4Values);
  ```

## row 行

+ 行
+ 可以添加一行或者同时添加多行数据，是使用最频繁的属性

  ```js
  // 通过 json 添加一行数据，需要先设置 columns
  worksheet.addRow({id: 1, name: 'John Doe', dob: new Date(1970,1,1)});
  worksheet.addRow({id: 2, name: 'Jane Doe', dob: new Date(1965,1,7)});
  // 通过数组添加一行数据
  worksheet.addRow([3, 'Sam', new Date()]);

  // 同时添加多行数据
  worksheet.addRows(list);

  // 遍历工作表中具有值的所有行
  worksheet.eachRow(function(row, rowNumber) {
    console.log('Row ' + rowNumber + ' = ' + JSON.stringify(row.values));
  });

  // 遍历工作表中的所有行（包括空行）
  worksheet.eachRow({ includeEmpty: true }, function(row, rowNumber) {
    console.log('Row ' + rowNumber + ' = ' + JSON.stringify(row.values));
  });

  // 连续遍历所有非空单元格
  row.eachCell(function(cell, colNumber) {
    console.log('Cell ' + colNumber + ' = ' + cell.value);
  });

  // 遍历一行中的所有单元格（包括空单元格）
  row.eachCell({ includeEmpty: true }, function(cell, colNumber) {
    console.log('Cell ' + colNumber + ' = ' + cell.value);
  });
  ```
