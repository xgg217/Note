# 文件下载

## 从互联网下载数据

+ 在实现“从互联网下载数据”方法时，我们使用 `createObjectURL`  显示图片，在请求互联网图片时，我们有两种方式：

+ 方式1 XMLHttpRequest



  ```js
  // XMLHttpRequest 下载
  const url = "http://images.pingan8787.com/TinyCompiler/111.png";
  const pingan = document.querySelector('#pingan');
  function download1 (){
    const xhr = new XMLHttpRequest();
    xhr.open('GET', url);
    xhr.responseType = 'blob';
    xhr.onload = () => {
      renderImage(xhr.response);
    }
    xhr.send(null);
  }
  ```

+ 方式2 fetch

  ```js
  const url = "http://images.pingan8787.com/TinyCompiler/111.png";
  const pingan = document.querySelector('#pingan');

  function download2 (){
    fetch(url).then(res => {
      return res.blob();
    }).then(myBlob => {
      renderImage(myBlob);
    })
  }

  function renderImage (data){
    let objectURL = URL.createObjectURL(data);
    pingan.src = objectURL;
  // 根据业务需要手动调用 URL.revokeObjectURL(imgUrl)
  }
  ```

+ 方式3

  ```js
  axios({ url, method: "get", responseType: "blob", timeout: 2000 * 10 })
    .then(res => {
      console.log(res);
    })
    .catch(err => {
      console.error(err);
    });
  ```


## 下载文件

+ 通过调用 Blob 的构造函数来创建类型为 `"text/plain"`  的 Blob 对象，然后通过动态创建 `a`  标签来实现文件的下载

  ```js
  // Blob 文件下载
  function download(){
    const fileName= "Blob文件.txt";
    const myBlob = new Blob(["一文彻底掌握 Blob Web API"], { type: "text/plain" });
    downloadFun(fileName, myBlob);
  }
  function downloadFun(fileName, blob){
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = fileName;
    link.click();
    link.remove();
    URL.revokeObjectURL(link.href);
  }
  ```
