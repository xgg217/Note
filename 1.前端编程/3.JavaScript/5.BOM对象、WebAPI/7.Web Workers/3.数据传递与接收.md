# 数据传递与接收

## 概述

+ 在主页面与 worker 之间传递的数据是通过拷贝，而不是共享来完成的。传递给 worker 的对象需要经过序列化，接下来在另一端还需要反序列化
+ 页面与 worker 不会共享同一个实例，最终的结果就是在每次通信结束时生成了数据的一个副本

## 参考

+ https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Workers_API/Using_web_workers#worker_%E4%B8%AD%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8E%A5%E6%94%B6%E4%B8%8E%E5%8F%91%E9%80%81%EF%BC%9A%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D

## 通过转让所有权（可转移对象）来传递数据

+ 可转移对象从一个上下文转移到另一个上下文而不会经过任何拷贝操作

  + 这意味着当传递大型数据集时会获得极大的性能提升

+ 例如，当你将一个 ArrayBuffer 对象从主应用转让到 Worker 中，原始的 ArrayBuffer 被清除并且无法使用。它包含的内容会（完整无差的）传递给 Worker 上下文

  ```js
  // 创建一个 32MB 的“文件”，用从 0 到 255 的连续数值填充它——32MB = 1024 * 1024 * 32
  const uInt8Array = new Uint8Array(1024 * 1024 * 32).map((v, i) => i);
  worker.postMessage(uInt8Array.buffer, [uInt8Array.buffer]);
  ```
