# 令牌的验证

## 概述

![image-20200422172837190](http://mdrs.yuanjin.tech/img/image-20200422172837190.png "image-20200422172837190")

## 验证

1. 首先，服务器要验证这个令牌是否被篡改过，验证方式非常简单，就是对 `header+payload` 用同样的秘钥和加密算法进行重新加密

2. 然后把加密的结果和传入jwt的 `signature` 进行对比，如果完全相同，则表示前面两部分没有动过，就是自己颁发的，如果不同，肯定是被篡改过了

    ```js
    传入的header.传入的payload.传入的signature

    新的signature = header中的加密算法(传入的header.传入的payload, 秘钥)

    验证：新的signature == 传入的signature
    ```

   + 当令牌验证为没有被篡改后，服务器可以进行其他验证：比如是否过期、听众是否满足要求等等，这些就视情况而定了

   + 注意：这些验证都需要服务器手动完成，没有哪个服务器会给你进行自动验证，当然，你可以借助第三方库来完成这些操作

   + 令牌在服务器组装完成后，会以任意的方式发送到客户端

   + 客户端会把令牌保存起来，后续的请求会将令牌发送给服务器
